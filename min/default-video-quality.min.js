(()=>{return(e,t)=>{const a=[{name:"1080P60",value:116},{name:"1080P+",value:112},{name:"1080P",value:80},{name:"720P",value:64},{name:"480P",value:32},{name:"360P",value:15},{name:"自动",value:0}];async function n(){const t=await SpinQuery.any(()=>$(".bilibili-player-video-quality-menu .bui-select-list>li.bui-select-item"));const[n]=t.toArray().map(e=>parseInt(e.getAttribute("data-value"))).sort(e=>e);const[i]=a.filter(t=>t.name===e.defaultVideoQuality).map(e=>e.value);const[l]=a.map(e=>e.value).filter(e=>e<=Math.min(i,n)).sort(e=>e);const u=await SpinQuery.condition(()=>document.querySelector("video"),e=>e);function r(){t.each((e,t)=>{if(parseInt(t.getAttribute("data-value"))===l){t.click()}});this.removeEventListener("play",r)}u.addEventListener("play",r)}Observer.subtree("#bofqi",()=>n())}})();