(()=>{return(e,i)=>{const n=[{name:"常规",action:()=>{}},{name:"宽屏",action:()=>{document.querySelector(".bilibili-player-video-btn-widescreen").click();document.querySelector("#bofqi").scrollIntoView({behavior:"smooth"})}},{name:"网页全屏",action:()=>{document.querySelector(".bilibili-player-video-web-fullscreen").click()}},{name:"全屏",action:()=>{document.querySelector(".bilibili-player-video-btn-fullscreen").click()}}];let t=()=>{};let o=()=>{};async function l(){if(e.autoLightOff){await SpinQuery.unsafeJquery();const e=await SpinQuery.any(()=>unsafeWindow.$(".bilibili-player-video-btn-setting"));if(!e){return}e.mouseover().mouseout();const i=async e=>{const i=await SpinQuery.select(()=>document.querySelector(".bilibili-player-video-btn-setting-panel-others-content-lightoff .bui-checkbox-input"));i.checked=e;raiseEvent(i,"change")};t=(()=>i(true));o=(()=>i(false))}}async function a(i){console.log("default player mode main executed");console.log(i);await l();await SpinQuery.condition(()=>$(".bilibili-player-video,.bilibili-player-video-btn-start,.bilibili-player-area"),e=>e.length===3&&$("video").length>0&&$("video").prop("duration"));const a=document.querySelector("video");if(!a){return}const r=n.find(i=>i.name===e.defaultPlayerMode);{const i=()=>{if(r&&$("#bilibiliPlayer[class*=mode-]").length===0){r.action()}if(e.autoPlay){t()}else{a.addEventListener("play",t,{once:true})}a.addEventListener("ended",o,{once:true})};if(e.applyPlayerModeOnPlay&&!e.autoPlay){a.addEventListener("play",i,{once:true})}else{i()}}}Observer.videoChange(a)}})();